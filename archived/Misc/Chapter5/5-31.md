## MySQL 流量隐写

MySQL 流程图如下

```sql
+-------------+                                    +-------------+
|  MySQL 客户端 |                                    |  MySQL 服务端 |
+-------------+                                    +-------------+
       |                                                  |
       | 1. 建立 TCP 连接 (端口 3306)                      |
       |------------------------------------------------->|
       |                                                  |
       | 2. 接收 Handshake Initialization Packet          |
       |<-------------------------------------------------|
       |                                                  |
       | 3. 发送 Login Request Packet (用户名、密码等)     |
       |------------------------------------------------->|
       |                                                  |
       | 4. 验证成功 → 发送 OK Packet                     |
       |    验证失败 → 发送 ERR Packet                    |
       |<-------------------------------------------------|
       |                                                  |
       | 5. 发送 SQL 请求（COM_QUERY）                    |
       |------------------------------------------------->|
       |                                                  |
       | 6. 返回结果（OK / ERR / ResultSet）              |
       |<-------------------------------------------------|
```

发现有 MySQL 流量，直接过滤

![](https://pic1.imgdb.cn/item/6882151a58cb8da5c8d60b13.png)

按照顺序前三个为一组可以发现在第三次时登录成功

![](https://pic1.imgdb.cn/item/6882185558cb8da5c8d61d70.png)

在后续的 Request 包中可以看到查询语句

![](https://pic1.imgdb.cn/item/6882191958cb8da5c8d6262f.png)

`row packet` 里都是返回结果

![](https://pic1.imgdb.cn/item/68821b0958cb8da5c8d63db5.png)



在响应包中可以找到 flag

![](https://pic1.imgdb.cn/item/688219c558cb8da5c8d62d28.png)
