## AES 破解

反编译 Apk 文件

![](https://pic1.imgdb.cn/item/68049fd458cb8da5c8b8c515.png)

核心函数如下

可以发现有个 `SecondActivity.class`

```java
public void onClick(View view) {
        switch (view.getId()) {
            case R.id.button1 /* 2131165187 */:
                if (this.c.getText().length() == 0 || this.d.getText().length() == 0) {
                    Toast.makeText(this, "不能为空", 1).show();
                    return;
                }
                String obj = this.c.getText().toString();
                String obj2 = this.d.getText().toString();
                Log.e("test", obj + " test2 = " + obj2);
                Intent intent = new Intent(this, (Class<?>) SecondActivity.class);
                intent.putExtra("ili", obj);
                intent.putExtra("lil", obj2);
                startActivity(intent);
                return;
            default:
                return;
        }
    }
```

进去看看

![](https://pic1.imgdb.cn/item/6804a39f58cb8da5c8b8d33b.png)

核心代码如下：

```java
if (Encryto.doRawData(this, stringExtra + stringExtra2).equals("VEIzd/V2UPYNdn/bxH3Xig==")) {
            intent.setAction("android.test.action.MoniterInstallService");
            intent.setClass(this, MoniterInstallService.class);
            intent.putExtra("company", "tencent");
            intent.putExtra("name", "hacker");
            intent.putExtra("age", 18);
            startActivity(intent);
            startService(intent);
        }
```

我们需要去看这个 `Encryto.doRawData` 是什么

双击进入发现为 `native`，并且下面有加载库 `JNIEncrypt`

![](https://pic1.imgdb.cn/item/6804a4c558cb8da5c8b8d783.png)

在左边资源文件中找到了同名的 so 文件

![](https://pic1.imgdb.cn/item/6804a6bf58cb8da5c8b8de6c.png)

IDA 加载找到了 `doRawData` 函数

很明显有使用 AES 加密，v10 则是密钥，v4 则是我们传入的值

![](https://pic1.imgdb.cn/item/6804a79858cb8da5c8b8e0a9.png)

得到密钥后寻找加密字符串在 `FileDataActivity` 中发现 `9YuQ2dk8CSaCe7DTAmaqAA==`

![](https://pic1.imgdb.cn/item/6804a91658cb8da5c8b8e440.png)

AES 解密拿到 flag

![](https://pic1.imgdb.cn/item/6804a94758cb8da5c8b8e4a7.png)
