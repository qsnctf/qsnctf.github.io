## INT3 反调试破解

32IDA 打开

![](https://pic1.imgdb.cn/item/6808f48c58cb8da5c8c6a891.png)

给出了 if 结构，我们直接打开的话是执行是第一部分，给出了乱码

![](https://pic1.imgdb.cn/item/6808fb2f58cb8da5c8c6abde.png)



所以我们要让程序走第二部分，在 OllyDbg 中载入动态调试，一直 F8 单步向下找到弹窗的位置

![](https://pic1.imgdb.cn/item/6809001d58cb8da5c8c6af5a.png)

在弹窗位置这里下断点按 F2

![](https://pic1.imgdb.cn/item/680900a258cb8da5c8c6afc3.png)

按 Ctrl+F2 重新载入

![](https://pic1.imgdb.cn/item/680901d758cb8da5c8c6b255.png)

按 F9 直接运行到断点位置

![](https://pic1.imgdb.cn/item/6809020a58cb8da5c8c6b279.png)

因为下一步就弹窗了，所以这里得 F7 步入进去

![](https://pic1.imgdb.cn/item/680902af58cb8da5c8c6b2db.png) 

到这里执行又弹窗了

![](https://pic1.imgdb.cn/item/680904f658cb8da5c8c6b48c.png)

重新执行一遍发现执行了这条指令跳转到了这里，下断点验证发现确实是这样

![](https://pic1.imgdb.cn/item/6809076c58cb8da5c8c6b695.png)

但是上面还有一条 JNZ 指令并未执行，重新打断点删除断点

![](https://pic1.imgdb.cn/item/68090a4058cb8da5c8c6b831.png)

我这里是直接改为 `JMP` 强制跳转，右键汇编或者直接空格

其他方法如下：

1. 直接修改 `EAX` 为非零值

   ```
   MOV EAX, 1      ; EAX ≠ 0 → TEST EAX,EAX 后 ZF=0 → JNZ 跳转
   ```

2. 直接修改 `EFLAGS`（`Z` 标志位）

   ```
   PUSHFD          ; 将 EFLAGS 压栈
   AND DWORD PTR [ESP], ~0x40  ; 清除 ZF（第 6 位）
   POPFD           ; 恢复修改后的 EFLAGS
   ```

![](https://pic1.imgdb.cn/item/680912d958cb8da5c8c6bdcd.png)

为了方便调试右键修改的指令 -> 编辑 -> 复制所有修改到可执行文件

![](https://pic1.imgdb.cn/item/6809152558cb8da5c8c6be93.png)

直接替换掉原始文件

![](https://pic1.imgdb.cn/item/6809156858cb8da5c8c6bea3.png)

这里有个 `INT3` 反调试，`nop` 掉

![](https://pic1.imgdb.cn/item/6809161f58cb8da5c8c6bee5.png)

继续 F8 走到这里后又没有结果了，再次 `nop` 掉

![](https://pic1.imgdb.cn/item/680916e258cb8da5c8c6bf24.png)

继续 F8 走到 `call Message` 这里弹窗了，忽略后继续走

下面那个 `JMP` 没有结果了，一样 `nop`

![](https://pic1.imgdb.cn/item/6809173a58cb8da5c8c6bf3e.png)

走到这一步时 flag 已经出来了

![](https://pic1.imgdb.cn/item/6809183058cb8da5c8c6bf8a.png)

看指令 `PUSH EAX` 应该是将 flag 放入了 `EAX` 中，右键跟随值可以在右下角看到 flag

![](https://pic1.imgdb.cn/item/6809186558cb8da5c8c6bf97.png)

往后面继续走也是弹窗给出了 flag

![](https://pic1.imgdb.cn/item/6809189458cb8da5c8c6bfa4.png)

