## n 为偶数推出 p = 2
远程连接发现发现生成的 N 全都是偶数

![](https://pic1.imgdb.cn/item/6884aa0258cb8da5c8e206fa.png)

RSA 的核心公式是：

> **N = p × q**

其中：

- p 和 q 是两个 **大素数**
- N 是它们的乘积，用作模数

标准 RSA 要求：

- **p 和 q 均为大素数**
- 且都必须是奇数（因为 2 之外的所有素数都是奇数）

**如果 N 为偶数那说明 p 和 q 中有一个是偶数**

**但唯一的偶数素数是 2**

所以 q 或 p 有一个是 2，这样我们就能直接分解 N

```python
from Crypto.Util.number import inverse, long_to_bytes

# 从服务获取的变量（示例）
N = 16749837321344130084550985102003550399956674386743058617704729879577640535719227688593462243296045193929408852118650789506962817745280185510940780886140638    # 从 nc 接口获取 N
e = 65537
c = 1522623953839932043052285485369632549836987965181940792893751469951454437696221766465918033070039098071178026515952768796327963296844494680671840051296757    # 从 nc 接口获取 ciphertext

# 利用 N 是偶数的破绽
p = 2
q = N // p

# 计算私钥 d，并解密
phi = (p - 1) * (q - 1)
d = inverse(e, phi)
m = pow(c, d, N)

flag = long_to_bytes(m).decode()
print(flag)
```

