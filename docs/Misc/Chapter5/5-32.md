## Redis 流量隐写

Redis 协议流程图如下

```
[客户端]
    |
    |  发送命令（RESP 协议格式）
    v
  +------------------------------------+
  | *3                                |
  | $3                                |
  | SET                               |
  | $4                                |
  | key1                              |
  | $6                                |
  | value1                            |
  +------------------------------------+
    |
    |  等待响应
    v
[Redis 服务器]
    |
    |  解析命令并执行
    v
  +--------------+
  | +OK\r\n      |  ← 简单字符串响应
  +--------------+
    |
    v
[客户端接收响应]
```

直接过滤 RESP 协议

![](https://pic1.imgdb.cn/item/68821f6958cb8da5c8d679b8.png)

首先来看第一个包

```yaml
6	12.525675	30.0.250.11	30.0.30.10	RESP	83	Request: COMMAND
```

`COMMAND` 是 Redis 的**元命令**，用于获取服务器支持的所有命令及其详细描述

所以后续这些响应都是 `COMMAND` 的结果

![](https://pic1.imgdb.cn/item/6882233658cb8da5c8d692a8.png)

这里可以直接看到设置的 flagflag

![](https://pic1.imgdb.cn/item/6882238758cb8da5c8d69343.png)
